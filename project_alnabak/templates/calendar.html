{% extends 'layout.html' %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/locales-all.min.js"></script>
{% endblock %}

{% block content %}
<div class="container">
    <h1>{{ _('Project Calendar') }}</h1>
    <div id='calendar'></div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      locale: '{{ g.locale }}', 
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,listWeek'
      },
      events: [
        {% for project in projects %}
        {
          title: '{{ project.title }} ({% if project.voting_deadline %}{{ _('Voting') }}{% else %}{{ _('Project') }}{% endif %})',
          start: '{{ project.start_date.strftime('%Y-%m-%d') if project.start_date }}',
          end: '{{ project.end_date.strftime('%Y-%m-%d') if project.end_date }}',
          url: '{{ url_for('project', project_id=project.id, locale=get_locale())  }}',
          color: '{% if project.voting_deadline %}#dc3545{% else %}#007bff{% endif %}' // Red for voting, Blue for project
        },
        {% endfor %}
      ]
    });

    calendar.render();
  });
</script>
{% endblock %}