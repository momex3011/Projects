{% extends 'layout.html' %}

{% block content %}
<div class="container">
    <h1>{{ project.title }}</h1>
    <div class="card">
        <p>{{ project.description }}</p>
        <p><strong>{{ _('Status') }}:</strong> {{ project.status }}</p>
        {% if project.category %}
            <p><strong>{{ _('Category') }}:</strong> {{ project.category }}</p>
        {% endif %}
        {% if project.tracker %}
            <p><strong>{{ _('Tracker') }}:</strong> {{ project.tracker.username }}</p>
        {% endif %}
        {% if project.voting_deadline %}
            <p><strong>{{ _('Voting Deadline') }}:</strong> {{ project.voting_deadline.strftime('%Y-%m-%d %H:%M') }}</p>
            {% if current_user.is_authenticated and current_user.role == 'council_member' and can_vote and not has_voted %}
                <div class="card">
                    <form method="POST" action="{{ url_for('vote', project_id=project.id, locale=get_locale())  }}">
                        {{ vote_form.hidden_tag() }}
                        <div class="form-group">
                            {{ vote_form.vote.label }}
                            {{ vote_form.vote(class="form-control") }}
                        </div>
                        <div class="form-group">
                            {{ vote_form.submit(class="btn btn-primary") }}
                        </div>
                    </form>
                </div>
            {% elif has_voted %}
                <p>{{ _('You have already voted on this project.') }}</p>
            {% elif not can_vote %}
                <p>{{ _('Voting is closed for this project.') }}</p>
            {% endif %}
            <a href="{{ url_for('view_results', project_id=project.id, locale=get_locale())  }}" class="btn btn-outline-info">{{ _('View Results') }}</a>
        {% endif %}

        <p><strong>{{ _('Start Date') }}:</strong> {{ project.start_date.strftime('%Y-%m-%d %H:%M') }}</p>
        <p><strong>{{ _('End Date') }}:</strong> {{ project.end_date.strftime('%Y-%m-%d %H:%M') }}</p>
        <div class="progress">
            <div class="progress-bar" style="width: {{ project.progress() }}%;"></div>
        </div>
    </div>
    <div>
        {% if current_user.is_authenticated %}
            {% if current_user.role == 'admin' %}
                <a href="{{ url_for('edit_project', project_id=project.id, locale=get_locale())  }}" class="btn btn-primary">{{ _('Edit Project') }}</a>
                <a href="{{ url_for('assign_tracker', project_id=project.id, locale=get_locale())  }}" class="btn btn-primary">{{ _('Assign Tracker') }}</a>
            {% elif current_user.role == 'tracker' and project.tracker_id == current_user.id %}
                <a href="{{ url_for('track_project', project_id=project.id, locale=get_locale())  }}" class="btn btn-primary">{{ _('Track Project') }}</a>
            {% endif %}
        {% endif %}
        <a href="{{ url_for('projects_list', locale=get_locale())  }}" class="btn btn-outline-info">{{ _('Back to Projects') }}</a>
         <a href="{{ url_for('volunteer_for_project', project_id=project.id, locale=get_locale()) }}" class="btn btn-success">{{ _('Voluntree') }}</a>
    </div>
</div>
{% endblock %}